<script>
    const translations = {
        ru: {
            title: "Универсальный Конвертер Валют",
            calculate: "Рассчитать",
            placeholderAmount: "Введите сумму",
            commissionPlaceholder: "Процент комиссии",
            footerText: "Разработано с ❤️ Ihor Dubai Real Estate",
            contactText: "Свяжитесь со мной:",
            convertedAmount: "Конвертированная сумма",
            finalAmount: "Итоговая сумма"
        },
        en: {
            title: "Universal Currency Converter",
            calculate: "Calculate",
            placeholderAmount: "Enter amount",
            commissionPlaceholder: "Commission Percentage",
            footerText: "Developed with ❤️ by Ihor Dubai Real Estate",
            contactText: "Contact me:",
            convertedAmount: "Converted Amount",
            finalAmount: "Final Amount"
        },
        ar: {
            title: "محول العملات العالمي",
            calculate: "احسب",
            placeholderAmount: "أدخل المبلغ",
            commissionPlaceholder: "نسبة العمولة",
            footerText: "تم التطوير بواسطة ❤️ Ihor Dubai Real Estate",
            contactText: "اتصل بي:",
            convertedAmount: "المبلغ المحول",
            finalAmount: "المبلغ النهائي"
        },
        ua: {
            title: "Універсальний Конвертер Валют",
            calculate: "Розрахувати",
            placeholderAmount: "Введіть суму",
            commissionPlaceholder: "Відсоток комісії",
            footerText: "Розроблено з ❤️ Ihor Dubai Real Estate",
            contactText: "Зв'яжіться зі мною:",
            convertedAmount: "Конвертована сума",
            finalAmount: "Загальна сума"
        }
    };

    async function fetchRates() {
        const response = await fetch("https://v6.exchangerate-api.com/v6/020c6e77213ba847f6eaaf32/latest/USD");
        const data = await response.json();
        return data.conversion_rates;
    }

    async function convertCurrency() {
        const amount = parseFloat(document.getElementById("amount").value);
        const fromCurrency = document.getElementById("fromCurrency").value;
        const toCurrency = document.getElementById("toCurrency").value;
        const commissionRate = parseFloat(document.getElementById("commission").value) || 0;
        const selectedLanguage = document.getElementById("languageSelector").value;

        if (isNaN(amount) || amount <= 0) {
            document.getElementById("result").textContent = translations[selectedLanguage].errorInvalidAmount || "Введите корректную сумму.";
            return;
        }

        const rates = await fetchRates();
        if (rates[fromCurrency] && rates[toCurrency]) {
            const baseAmount = amount / rates[fromCurrency];
            const convertedAmount = baseAmount * rates[toCurrency];
            const commission = (commissionRate / 100) * convertedAmount;
            const totalAmount = convertedAmount - commission;

            document.getElementById("result").innerHTML = `
                ${translations[selectedLanguage].convertedAmount}: ${convertedAmount.toFixed(2)} ${toCurrency}<br>
                ${translations[selectedLanguage].finalAmount}: ${totalAmount.toFixed(2)} ${toCurrency}
            `;
        } else {
            document.getElementById("result").textContent = translations[selectedLanguage].errorConversion || "Ошибка конвертации валют.";
        }
    }

    function translateUI(language) {
        document.getElementById("title").textContent = translations[language].title;
        document.getElementById("convertButton").textContent = translations[language].calculate;
        document.getElementById("amount").placeholder = translations[language].placeholderAmount;
        document.getElementById("commission").placeholder = translations[language].commissionPlaceholder;
        document.getElementById("footerText").textContent = translations[language].footerText;
        document.getElementById("contactText").textContent = translations[language].contactText;
    }

    document.getElementById("languageSelector").addEventListener("change", function () {
        const selectedLanguage = this.value;
        translateUI(selectedLanguage);
    });

    document.getElementById("convertButton").addEventListener("click", convertCurrency);
</script>
